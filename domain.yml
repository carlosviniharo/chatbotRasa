version: "3.1"

intents:
  - start_conversation
  - inform_identity
  - choose_option
  - affirm
  - deny
  - loan_info
  - open_loan
  - inform_fullname
  - inform_city
  - inform_phone
  - inform_email
  - goodbye

entities:
  - identity
  - option
  - disclosure
  - loan_type
  - fullname
  - city
  - phone
  - email

forms:
  client_info_loan_form:
    required_slots:
      - fullname
      - city
      - phone
      - email

slots:
  identity:
    type: text
    mappings:
      - type: from_entity
        entity: identity
    influence_conversation: false

  disclosure:
    type: bool
    mappings:
      - type: from_intent
        intent: affirm
        value: true
      - type: from_intent
        intent: deny
        value: false
    influence_conversation: true

  option:
    type: text
    mappings:
      - type: from_entity
        entity: option

  loan_type:
    type: float
    mappings:
      - type: from_intent
        intent: loan_info
        value: 1
      - type: from_intent
        intent: open_loan
        value: 2

  fullname:
    type: text
    mappings:
      - type: from_entity
        entity: fullname

  city:
    type: text
    mappings:
      - type: from_entity
        entity: city

  phone:
    type: float
    mappings:
      - type: from_entity
        entity: phone
        conditions:
        - active_loop: client_info_loan_form
          requested_slot: phone

  email:
    type: text
    mappings:
      - type: from_entity
        entity: email

responses:
# Responses for the star of the conversation where it asks the id and the descalaimer of use of personal data.
  utter_start_conversation:
    - text: | 
        ¬°Hola! Bienvenido/@ üòä Gracias por comunicarte con la Cooperativa de Ahorro y Cr√©dito Pilahuin Tio Ltda. 
        La Cooperativa Que Cree En Su Gente.
        Soy PTIO su asistente virtual üß°üñ§

  utter_ask_identity:
    - text: "Antes de comenzar me puedes brindar tu n√∫mero de identificaci√≥n (por ejemplo, 100415088-3)"

  utter_disclaimer:
    - text: |
        Al utilizar este canal digital autorizas a la Cooperativa de Ahorro y Cr√©dito Pilahuin Tio Ltda. a acceder a tus datos personales 
        para la gesti√≥n de requerimientos y consultas en general. Para m√°s informaci√≥n sobre los t√©rminos y condiciones visita 
        https://www.pilahintio.com.ec/terminos-y-condiciones
        ¬øAceptas los t√©rminos y condiciones?
# Responses for the main option menu
  utter_services:
    - text: |
        Estas son las opciones en las que podemos ayudarte:
        1. Inversiones
        2. Cr√©ditos
        3. Aperturas de cuentas

        Por favor, elige una opci√≥n (por ejemplo, Cr√©ditos).

# Reponses for the the option loan
  utter_loans:
    - text: |
        Le ofrecemos las siguientes opciones de asistencia con respecto a cr√©ditos:
          1 - Informaci√≥n de mis cr√©ditos vigentes.
          2 - Solicitar un nuevo cr√©dito.

  utter_open_loan:
    - text: |
        We woudl need the following information to open a new loan


#  Responses for the forms, both cases when it is the first case and when the input does not goes throught the validation.
  utter_ask_fullname:
    - text:  |
        Por favor, para acceder a la informaci√≥n ser√≠a tan amable de brindarme sus nombres y apellidos tal y como aparecen en su c√©dula
        (e.g. Juan Alexander Mazabanda Momposita)

  utter_ask_city:
    - text: "La ciudad de donde se comunica (e.g. Otavalo)"

  utter_ask_phone:
    - text: "Su n√∫mero de celular (e.g. 0954238704)"

  utter_ask_email:
    - text: "Su correo electr√≥nico (e.g. juan@jakaysa.com)"

  utter_invalid_fullname:
    - text: "El nombre proporcionado no es v√°lido. Por favor, intenta nuevamente."

  utter_invalid_city:
    - text: "La ciudad proporcionada no es v√°lida. Por favor, intenta nuevamente."

  utter_invalid_phone:
    - text: "El n√∫mero de tel√©fono proporcionado no es v√°lido. Por favor, intenta nuevamente."
    
# Respinces for summary and submition of the forms
  utter_slots_values:
    - text: |
        Los datos ingresados son los siguientes:
        - Nombres Completos: {fullname}
        - Lugar de donde se comunica: {city}
        - N√∫mero telef√≥nico: {phone}
        - Correo electr√≥nico: {email}
  
  utter_submit:
  - text: "¬°Tenemos tus datos!"

  utter_ask_rephrase:
    - text: "Ups tu ultimo mensaje no lo pude entender, podrias por favor volve a intentarlo"

# Responses for the end of the conversations.
  utter_end_loan_info:
    - text: |
        Gracias por contactarse con la Cooperativa de Ahorro y Cr√©dito Pilahuin Tio Ltda. 
        En el transcurso del d√≠a un asesor de cr√©dito se comunicar√° con usted mediante llamada telef√≥nica 
        y le brindar√° la informaci√≥n correspondiente.

  utter_goodbye:
    - text: "Adi√≥s, ¬°que tengas un buen d√≠a!"

actions:
  - action_end_conversation
  - action_validate_id
  - action_show_option
  - validate_client_info_loan_form

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true
